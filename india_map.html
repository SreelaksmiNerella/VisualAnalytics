<!DOCTYPE html>
<html lang="en">
<head>
    
    <!-- start: Meta -->
    <meta charset="utf-8">
    <title>Visual Analytics of Terrorism Data</title>
    <meta name="description" content="Bootstrap Metro Dashboard">
    <meta name="author" content="Dennis Ji">
    <meta name="keyword" content="Metro, Metro UI, Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
    <!-- end: Meta -->
    
    <!-- start: Mobile Specific -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- end: Mobile Specific -->
    
    <!-- start: CSS -->
    <link id="bootstrap-style" href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-responsive.min.css" rel="stylesheet">
    <link id="base-style" href="css/style.css" rel="stylesheet">
    <link id="base-style-responsive" href="css/style-responsive.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800&subset=latin,cyrillic-ext,latin-ext' rel='stylesheet' type='text/css'>
    <!-- end: CSS -->
    

    <!-- The HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <link id="ie-style" href="css/ie.css" rel="stylesheet">
    <![endif]-->
    
    <!--[if IE 9]>
        <link id="ie9style" href="css/ie9.css" rel="stylesheet">
    <![endif]-->
        
    <!-- start: Favicon -->
    <link rel="shortcut icon" href="img/favicon.ico">
    <!-- end: Favicon -->
    
     


<style>


.canton-boundary {
  fill: none;
  stroke: #fff;
  stroke-linejoin: round;
}

text {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 10px;
  text-anchor: middle;
}


.d3-tip {
        line-height: 1;
        font-weight: bold;
        padding: 12px;
        background: black;
        color: #fff;
        border-radius: 2px;
        opacity: 0.001%;
      }
      .d3-tip:after {
        box-sizing: border-box;
        display: inline;
        font-size: 10px;
        width: 100%;
        line-height: 1;
        color: black;
        content: "\25BC";
        position: absolute;
        text-align: center;
        opacity: 0.001%;
      }

      .d3-tip.n:after {
        margin: -1px 0 0 0;
        top: 100%;
        left: 0;
        opacity: 0.001%;
      }
      .area:hover {
        fill: brown;
      }
      .legend {
            padding: 5px;
            font: 10px sans-serif;
            background: yellow;
            box-shadow: 2px 2px 1px #888;
        }
      
</style>
   
        
        
</head>

<body>
        <!-- start: Header -->
    <div class="navbar">
        <div class="navbar-inner">
            <div class="container-fluid">
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".top-nav.nav-collapse,.sidebar-nav.nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>
                <a class="brand" href="index.html"><span>Visual Analytics of Terrorism Data</span></a>
                                
                <!-- start: Header Menu -->
                <div class="nav-no-collapse header-nav">
                    <ul class="nav pull-right">
                         <!-- start: User Dropdown -->
                        <li class="dropdown">
                            <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
                                <i class="halflings-icon white user"></i> Admin
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="login.html"><i class="halflings-icon off"></i> Logout</a></li>
                            </ul>
                        </li>
                        <!-- end: User Dropdown -->
                    </ul>
                </div>
                <!-- end: Header Menu -->
                
            </div>
        </div>
    </div>
    <!-- start: Header -->
    
        <div class="container-fluid-full">
        <div class="row-fluid">
                
            <!-- start: Main Menu -->
            <div id="sidebar-left" class="span2">
                <div class="nav-collapse sidebar-nav">
                    <ul class="nav nav-tabs nav-stacked main-menu">
                        <li><a href="homepage.html"><i class="icon-dashboard"></i><span class="hidden-tablet"> Dashboard</span></a></li>   
                       
                        
                         <li><a href="network.html"><i class="icon-list-alt"></i><span class="hidden-tablet"> Network Analysis</span></a></li>

                        <li><a href="graph.html"><i class="icon-bar-chart"></i><span class="hidden-tablet"> Graph Analysis</span></a></li>
                    
                        
                        <li><a href="login.html"><i class="icon-lock"></i><span class="hidden-tablet"> Login Page</span></a></li>
                    </ul>
                </div>
            </div>
            <!-- end: Main Menu -->
            
            <noscript>
                <div class="alert alert-block span10">
                    <h4 class="alert-heading">Warning!</h4>
                    <p>You need to have <a href="http://en.wikipedia.org/wiki/JavaScript" target="_blank">JavaScript</a> enabled to use this site.</p>
                </div>
            </noscript>
            
            <!-- start: Content -->
            <div id="content" class="span10">
            
            
            <ul class="breadcrumb">
                <li>
                    <i class="icon-home"></i>
                    <a href="index.html">Home</a> 
                    <i class="icon-angle-right"></i>
                </li>
                <li><a href="#">Dashboard</a></li>
            </ul>
            
           <div class="row pull-right well">    
            <div class="btn-group">

                            <button class="btn btn-large">Select Decade</button>
                            <button class="btn btn-large dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>
                            <ul class="dropdown-menu" data-class="decade">
                                <li data-value ="one"><i class="halflings-icon calendar"></i> 1970-79</a></li>
                                <li data-value ="two"><i class="halflings-icon calendar"></i> 1980-89</a></li>
                                <li data-value ="three"><i class="halflings-icon calendar"></i> 1990-99</a></li>
                                <li data-value ="four"><i class="halflings-icon calendar"></i> 2000-09</a></li>
                                <li data-value ="five"><i class="halflings-icon calendar"></i>2010-14</a></li>
                                 <li data-value ="news"><i class="halflings-icon calendar"></i>Latest News</a></li>
                                <li data-value ="tweet"><i class="halflings-icon calendar"></i>Latest Tweets</a></li>
                                
                                
                            </ul>

                           
            </div>

             <div class="btn-group">

                            <button class="btn btn-large">Select Type of Analysis</button>
                            <button class="btn btn-large dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>
                            <ul class="dropdown-menu" data-class="type">
                                <li data-value ="pie"><i class=""></i> Pie Chart</a></li>
                                <li data-value ="map"><i class="icon-map-marker"></i> Map</a></li>
                                </ul>

                           
            </div>

            <div class="btn-group ">
            <button class="btn btn-large">Select Criteria</button>
                            <button class="btn btn-large dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>
                            <ul class="dropdown-menu" data-class= "criteria">
                              
                                
                            </ul>
            </div>
            </div>
          <div id = "map" style = "float : left; min-width:320px;width :50%;height : 600px"> 
            <div id="subtitle"></div>
              </div>
                
       

    </div><!--/.fluid-container-->
    
            <!-- end: Content -->
        </div><!--/#content.span10-->
        </div><!--/fluid-row-->
        
    
    
    <div class="clearfix"></div>
    
    <footer>

        <p>
            <span style="text-align:left;float:left">&copy; 2016 </span>
            
        </p>

    </footer>

<!-- start: JavaScript-->

        <script src="js/jquery-1.9.1.min.js"></script>
    <script src="js/jquery-migrate-1.0.0.min.js"></script>
    
        <script src="js/jquery-ui-1.10.0.custom.min.js"></script>
    
        <script src="js/jquery.ui.touch-punch.js"></script>
    
        <script src="js/modernizr.js"></script>
    
        <script src="js/bootstrap.min.js"></script>
    
        <script src="js/jquery.cookie.js"></script>
    
        <script src='js/fullcalendar.min.js'></script>
    
        <script src='js/jquery.dataTables.min.js'></script>

        <script src="js/excanvas.js"></script>
    <script src="js/jquery.flot.js"></script>
    <script src="js/jquery.flot.pie.js"></script>
    <script src="js/jquery.flot.stack.js"></script>
    <script src="js/jquery.flot.resize.min.js"></script>
    
        <script src="js/jquery.chosen.min.js"></script>
    
        <script src="js/jquery.uniform.min.js"></script>
        
        <script src="js/jquery.cleditor.min.js"></script>
    
        <script src="js/jquery.noty.js"></script>
    
        <script src="js/jquery.elfinder.min.js"></script>
    
        <script src="js/jquery.raty.min.js"></script>
    
        <script src="js/jquery.iphone.toggle.js"></script>
    
        <script src="js/jquery.uploadify-3.1.min.js"></script>
    
        <script src="js/jquery.gritter.min.js"></script>
    
        <script src="js/jquery.imagesloaded.js"></script>
    
        <script src="js/jquery.masonry.min.js"></script>
    
        <script src="js/jquery.knob.modified.js"></script>
    
        <script src="js/jquery.sparkline.min.js"></script>
    
        <script src="js/counter.js"></script>
    
        <script src="js/retina.js"></script>

        <script src="js/custom.js"></script>
    <script src="http://colorbrewer2.org/export/colorbrewer.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>

<script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
                 
    

<script>
var mydecade;
var year;
var file;
var decade;
        var type;
        var criteria;
        var servfile;
        var loc;

        $(".btn-group .dropdown-menu[data-class='decade']").click(function(event){
            decade = $(event.target).attr("data-value");
            console.log(decade);
           
        });
        $(".btn-group .dropdown-menu[data-class='type']").click(function(event){
            type = $(event.target).attr("data-value");
            console.log(type);
                switch(type)
            {   
                case "pie": servfile = "pie.php";loc = "pie.html"; 
                if(decade=="news"||decade=="tweet")
                {
                    $(".btn-group .dropdown-menu[data-class='criteria']").html('<li data-value ="attacktype1_txt"><i class="fa-pie-chart "></i>Attack Type</a></li><li data-value ="city"><i class="fa-pie-chart "></i>Cities</a></li><li data-value ="gname"><i class="fa-pie-chart "></i>Terrorist Groups</a></li>'
                               );
                }
                else
                {
                  $(".btn-group .dropdown-menu[data-class='criteria']").html('<li data-value ="attacktype1_txt"><i class="fa-pie-chart "></i>Attack Type</a></li><li data-value ="city"><i class="fa-pie-chart "></i>Cities</a></li><li data-value ="gname"><i class="fa-pie-chart "></i>Terrorist Groups</a></li><li data-value ="targtype1_txt"><i class="fa-pie-chart "></i>Target Type</a></li>'
                               );
  
                }
                

                

                    break;
                case "map":servfile="";
                if(decade=="news"||decade=="tweet")
                {
                        $(".btn-group .dropdown-menu[data-class='criteria']").html('<li data-value ="india_map"><i class="halflings-icon white download-alt"></i> Map For Attacks</a></li>');
                }
                else
                {
                $(".btn-group .dropdown-menu[data-class='criteria']").html('<li data-value ="map_max_attack"><i class="halflings-icon white download-alt"></i>Map For Max Attacks</a></li> <li data-value ="india_map"><i class="halflings-icon white download-alt"></i> Map For Attacks</a></li><li data-value ="india_map_target"><i class="halflings-icon white download-alt"></i> Map For Targets</a></li>');
                }
              
            }
            
            });

        $(".btn-group .dropdown-menu[data-class='criteria']").click(function(event){
            criteria = $(event.target).attr("data-value");
            switch(criteria)
            {

                case "map_max_attack": servfile = ""; loc = "map_max_attack.html";
                    break;
                case "india_map": servfile = ""; loc = "india_map.html";
                    break;
                case "india_map_target": servfile = ""; loc = "india_map_target.html";
                    break;
            }
            console.log(criteria);
            console.log(servfile);
            console.log(loc);
            if(criteria=="map_max_attack"||criteria=="india_map"||criteria=="india_map_target")
            {
                localStorage.setItem("decade",decade);
                window.location.replace(loc);
            }
            else
            {
                            var data = {
                "decade": decade,
                "type": type,
                "criteria": criteria

                };

                console.log(data);
                $.ajax({
                type: "POST",
                dataType: "json",
                url: servfile, //Relative or absolute path to response.php file
                data: data,
                success: function(data) {
               
                data = JSON.stringify(data);
                localStorage.setItem('data', data);
                   window.location.replace(loc);

            }
            });

           }
       

        });
 $(document).ready(function() {
    mydecade = localStorage.getItem("decade");
    //console.log(decade);
    switch(mydecade)
    {
        case "one":year = "1970-79";break;
        case "two":year = "1980-89";break;
        case "three":year = "1990-99";break;
        case "four":year = "2000-09";break;
        case "five":year = "2010-14";break;
        case "news":year = "news";break;
        case "tweet":year= "tweet";break;
    }
    file = year+"-locations.csv";
    console.log(file);
  var places1 =[];var places2 =[];var places3 =[];var places4 =[];var places5 =[];var places6 =[];var places7 =[];
    var places8 =[];
  
    $.ajax({
        type: "GET",
        url: file,
        dataType: "text",
        success: function(data) {processData(data);}
     });
     
 
 function processData(allText) {
        
   var allTextLines = allText.split(/\r\n|\n/);
    
    for (var i=0; i<allTextLines.length; i++) 
    {
        var data = allTextLines[i].split(',');
        if(data[1]!="Unknown" && data[2]!="Unknown")
        {
            var mydata ={
            name :String(data[0]),
            location: {
                latitude:data[1],
                longitude:data[2]
            }
        };
     
     if(data[3]=="Armed Assault")
     {
        places1.push(mydata);
        
     }
    else if(data[3]=="Assassination")
     {
        places2.push(mydata);
     }
     else if(data[3]=="Bombing"||data[3]=="bombing")
     {
        places3.push(mydata);
     }
     else if(data[3]=="Infrastructure Attack")
     {
        places4.push(mydata);
     }
     else if(data[3]=="Hijacking")
     {
        places5.push(mydata);
     }
     else if(data[3]=="Barricade Incident")
     {
        places6.push(mydata);
     }
     else if(data[3]=="Kidnapping" ||data[3]=="kidnapping")
     {
        places7.push(mydata);
     }
     else if(data[3]=="Unarmed Assaults")
     {
        places8.push(mydata);
     }
    
      
   }
    }



var projection = d3.geo.mercator().scale(1100).translate([-1000,800]);
var path = d3.geo.path()
    .projection(projection);

var svg = d3.select("#map").append("svg")
    .attr("viewBox", "0 0 900 800")
     .attr("preserveAspectRatio", "xMidYMid meet");
var data;
d3.json("test.json", function(error, swiss) {
  if (error) throw error;

  var cantons = topojson.feature(swiss, swiss.objects.india);
  
            //svg.call(tip);
            var group=svg.selectAll("g")
                .data(cantons.features)
                .enter()
                .append("g");
                //.on('mouseover', tip.show)
                //.on('mouseout', tip.hide)
                    
                    
                    var tip = d3.tip()
                            .attr('class', 'd3-tip')
                            .offset([-5, 0])
                            .style("left", "300px")
                            .style("top", "400px")
                            .html(function(d) {
                                return ("<a href="+d.nam+" target='_blank'>"+d.name +"</a>");
                            })
                            
                        svg.call(tip);

//
                        svg.selectAll(".pin")
                          .data(places1)
                          .enter().append("circle", ".pin")

                          .attr("r", 5)
                          .style("fill", "red")
                            .style("stroke", "black")
                          .attr("transform", function(d) {
                            return "translate(" + projection([
                              d.location.longitude,
                              d.location.latitude
                            ]) + ")";
                          })
                           .on('mouseover', tip.show)
                            .on('click', tip.hide);


                            svg.selectAll(".pin")
                          .data(places2)
                          .enter().append("circle", ".pin")
                          .attr("r", 5)
                          .style("fill", "yellow")
                            .style("stroke", "black")
                          .attr("transform", function(d) {
                            return "translate(" + projection([
                              d.location.longitude,
                              d.location.latitude
                            ]) + ")";
                          })
                           .on('mouseover', tip.show)
                            .on('click', tip.hide);     

                            svg.selectAll(".pin")
                          .data(places3)
                          .enter().append("circle", ".pin")
                          .attr("r", 5)
                          .style("fill", "purple")
                            .style("stroke", "black")
                          .attr("transform", function(d) {
                            return "translate(" + projection([
                              d.location.longitude,
                              d.location.latitude
                            ]) + ")";
                          })
                           .on('mouseover', tip.show)
                            .on('click', tip.hide);


svg.selectAll(".pin")
                          .data(places4)
                          .enter().append("circle", ".pin")
                          .attr("r", 5)
                          .style("fill", "green")
                            .style("stroke", "black")
                          .attr("transform", function(d) {
                            return "translate(" + projection([
                              d.location.longitude,
                              d.location.latitude
                            ]) + ")";
                          })
                           .on('mouseover', tip.show)
                            .on('click', tip.hide);


svg.selectAll(".pin")
                          .data(places5)
                          .enter().append("circle", ".pin")
                          .attr("r", 5)
                          .style("fill", "blue")
                            .style("stroke", "black")
                          .attr("transform", function(d) {
                            return "translate(" + projection([
                              d.location.longitude,
                              d.location.latitude
                            ]) + ")";
                          })
                           .on('mouseover', tip.show)
                            .on('click', tip.hide);


svg.selectAll(".pin")
                          .data(places6)
                          .enter().append("circle", ".pin")
                          .attr("r", 5)
                          .style("fill", "pink")
                            .style("stroke", "black")
                          .attr("transform", function(d) {
                            return "translate(" + projection([
                              d.location.longitude,
                              d.location.latitude
                            ]) + ")";
                          })
                           .on('mouseover', tip.show)
                            .on('click', tip.hide);


svg.selectAll(".pin")
                          .data(places7)
                          .enter().append("circle", ".pin")
                          .attr("r", 5)
                          .style("fill", "orange")
                            .style("stroke", "black")
                          .attr("transform", function(d) {
                            return "translate(" + projection([
                              d.location.longitude,
                              d.location.latitude
                            ]) + ")";
                          })
                           .on('mouseover', tip.show)
                            .on('click', tip.hide);


svg.selectAll(".pin")
                          .data(places8)
                          .enter().append("circle", ".pin")
                          .attr("r", 5)
                          .style("fill", "black")
                            .style("stroke", "black")
                          .attr("transform", function(d) {
                            return "translate(" + projection([
                              d.location.longitude,
                              d.location.latitude
                            ]) + ")";
                          })
                           .on('mouseover', tip.show)
                            .on('click', tip.hide);

                //var projection = d3.geo.mercator().scale(900).translate([-600,700]);
                var path= d3.geo.path().projection(projection);

                var areas= group.append("path")
                    .attr("d", path)
                    .attr("class", "area")
                 .attr("fill","steelblue");

                 

var legend = svg.append("g")
  .attr("class", "legend")
  .attr("x", 65)
  .attr("y", 25)
  .attr("height", 400)
  .attr("width", 400);

legend.append("rect")
  .attr("x",65)
  .attr("y", 25)
  .attr("width", 40)
  .attr("height", 40)
  .style("fill", "red");

  legend.append("text")
  .attr("x",  150)
  .attr("y", 35)
  .text("Armed Assault");


  legend.append("rect")
  .attr("x",65)
  .attr("y", 65)
  .attr("width", 40)
  .attr("height", 40)
  .style("fill", "yellow");

  legend.append("text")
  .attr("x",  150)
  .attr("y", 75)
  .text("Assassination");


  legend.append("rect")
  .attr("x",65)
  .attr("y", 105)
  .attr("width", 40)
  .attr("height", 40)
  .style("fill", "purple");

  legend.append("text")
  .attr("x",  150)
  .attr("y", 115)
  .text("Bombing");

  legend.append("rect")
  .attr("x",65)
  .attr("y", 145)
  .attr("width", 40)
  .attr("height", 40)
  .style("fill", "green");

  legend.append("text")
  .attr("x",  150)
  .attr("y", 155)
  .text("Infrastructure Attack");

  legend.append("rect")
  .attr("x",65)
  .attr("y", 185)
  .attr("width", 40)
  .attr("height", 40)
  .style("fill", "blue");

  legend.append("text")
  .attr("x",  150)
  .attr("y", 195)
  .text("Hijacking");

  legend.append("rect")
  .attr("x",65)
  .attr("y", 225)
  .attr("width", 40)
  .attr("height", 40)
  .style("fill", "pink");

  legend.append("text")
  .attr("x",  150)
  .attr("y", 235)
  .text("Barricade Incident");

  legend.append("rect")
  .attr("x",65)
  .attr("y", 265)
  .attr("width", 40)
  .attr("height", 40)
  .style("fill", "orange");

  legend.append("text")
  .attr("x",  150)
  .attr("y", 275)
  .text("Kidnapping");

  legend.append("rect")
  .attr("x",65)
  .attr("y", 305)
  .attr("width", 40)
  .attr("height", 40)
  .style("fill", "black");

  legend.append("text")
  .attr("x",  150)
  .attr("y", 315)
  .text("Unarmed Assaults");
                
});

}


}); 

</script>



    
</body>
</html>
    